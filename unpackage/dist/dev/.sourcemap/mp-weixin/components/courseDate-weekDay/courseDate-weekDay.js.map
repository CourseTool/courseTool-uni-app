{"version":3,"file":"courseDate-weekDay.js","sources":["components/courseDate-weekDay/courseDate-weekDay.vue","/Users/zhangrui/Library/Mobile Documents/com~apple~CloudDocs/Desktop/桌面/WeChatApp/course-wechat/components/courseDate-weekDay/courseDate-weekDay.vue?type=component"],"sourcesContent":["<template>\r\n\t<view class=\"week-date\">\r\n\t\t<div class=\"time-list\">\r\n\t\t\t<div @click=\"changeDay(date)\" :class=\"{select:props.modelValue === weekDayMap[date.weekDay]}\"\r\n\t\t\t\tclass=\"date-item\" v-for=\"(date,i) in weekDayTimeList\" :key=\"i\">\r\n\t\t\t\t<div class=\"weekDay\" :class=\"{hasC:hasCourseList.includes(weekDayMap[date.weekDay])}\">\r\n\t\t\t\t\t<span>{{weekDayMap[date.weekDay].substring(2)}}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"day\">\r\n\t\t\t\t\t<span>{{date.day}}</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tonMounted,\r\n\t\tref,\r\n\t\tdefineEmits,\r\n\t\tdefineProps,\r\n\t\twatch,\r\n\t\tdefineExpose\r\n\t} from 'vue'\r\n\timport {\r\n\t\tmonthMap\r\n\t} from '@/uilts/time.js'\r\n\r\n\tconst props = defineProps([\"modelValue\", \"date\", \"hasCourseList\"])\r\n\tconst emit = defineEmits([\"update:modelValue\", \"changeWeekDay\"])\r\n\tconst weekDayTimeList = ref([])\r\n\tconst currentDay = ref(0)\r\n\tconst currentWeekDay = ref()\r\n\tconst weekDayMap = {\r\n\t\t\"1\": \"星期一\",\r\n\t\t\"2\": \"星期二\",\r\n\t\t\"3\": \"星期三\",\r\n\t\t\"4\": \"星期四\",\r\n\t\t\"5\": \"星期五\",\r\n\t\t\"6\": \"星期六\",\r\n\t\t\"7\": \"星期日\",\r\n\t}\r\n\r\n\tfunction getWeekDayTime() {\r\n\t\t// debugger\r\n\t\tconst date = props.date\r\n\t\tvar month = props.date.getMonth() + 1\r\n\t\t// 月的当前日\r\n\t\tconst day = date.getDate()\r\n\t\tcurrentDay.value = day\r\n\t\t// 当前星期几\r\n\t\tconst weekDay = date.getDay() === 0 ? 7 : date.getDay()\r\n\t\tcurrentWeekDay.value = weekDayMap[weekDay]\r\n\t\tconst result = []\r\n\t\tconst right = 7 - weekDay\r\n\t\tconst left = 7 - right\r\n\t\t// debugger\r\n\t\t// 生成左边日期\r\n\t\tfor (let d = left - 1; d >= 0; d--) {\r\n\t\t\tlet prevDay = day - d\r\n\t\t\tconst prevWeekDay = weekDay - d\r\n\t\t\tlet m = month\r\n\t\t\tif (prevDay <= 0) {\r\n\t\t\t\tif (month === 1) {\r\n\t\t\t\t\tprevDay = monthMap[12] + prevDay;\r\n\t\t\t\t\tm = 12\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprevDay = monthMap[month - 1] + prevDay;\r\n\t\t\t\t\tm = m - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresult.push({\r\n\t\t\t\tday: prevDay,\r\n\t\t\t\tweekDay: prevWeekDay,\r\n\t\t\t\tmonth: m\r\n\t\t\t})\r\n\t\t}\r\n\t\t// 生成右边的日期\r\n\t\tfor (let d = right; d > 0; d--) {\r\n\t\t\tlet nextDay = day + d\r\n\t\t\tconst nextWeekDay = weekDay + d\r\n\t\t\tlet m = month;\r\n\r\n\t\t\t// 判断是否跨年\r\n\t\t\tif (m === 12 && nextDay > monthMap[m]) {\r\n\t\t\t\tnextDay = (day + d) - monthMap[month]\r\n\t\t\t\tm = 1\r\n\r\n\t\t\t}\r\n\t\t\t// 判断是否跨月\r\n\t\t\tif (nextDay > monthMap[month]) {\r\n\t\t\t\tnextDay = nextDay - monthMap[month]\r\n\t\t\t\tm = m + 1\r\n\t\t\t}\r\n\r\n\t\t\tresult.push({\r\n\t\t\t\tday: nextDay,\r\n\t\t\t\tweekDay: nextWeekDay,\r\n\t\t\t\tmonth: m\r\n\t\t\t})\r\n\t\t}\r\n\t\tresult.sort((a, b) => a.weekDay - b.weekDay)\r\n\t\tweekDayTimeList.value = result\r\n\t\tconsole.log(weekDayTimeList.value)\r\n\t}\r\n\r\n\tfunction nextWeekDay() {\r\n\t\tconst currentIndex = props.date.getDay()\r\n\t\tconst newDate = {\r\n\t\t\tday: props.date.getDate() + 1,\r\n\t\t\tweekDay: currentIndex + 1,\r\n\t\t\tmonth: props.date.getMonth() + 1\r\n\t\t}\r\n\t\tchangeDay(newDate)\r\n\t}\r\n\r\n\tfunction prevWeekDay() {\r\n\t\tlet currentIndex = props.date.getDay() === 0 ? \"7\" : props.date.getDay()\r\n\t\tif (currentIndex === 1) {\r\n\t\t\tcurrentIndex = 8\r\n\t\t}\r\n\t\tconst newDate = {\r\n\t\t\tday: props.date.getDate() - 1,\r\n\t\t\tweekDay: currentIndex - 1,\r\n\t\t\tmonth: props.date.getMonth() + 1\r\n\t\t}\r\n\t\tchangeDay(newDate)\r\n\t}\r\n\r\n\tfunction changeDay(date) {\r\n\t\tconsole.log(date)\r\n\t\tcurrentDay.value = date.day\r\n\t\tcurrentWeekDay.value = weekDayMap[date.weekDay]\r\n\t\temit(\"update:modelValue\", currentWeekDay.value)\r\n\t\temit(\"changeWeekDay\", date)\r\n\t}\r\n\r\n\tdefineExpose({\r\n\t\tnextWeekDay,\r\n\t\tprevWeekDay\r\n\t})\r\n\r\n\twatch(\r\n\t\t() => props.date,\r\n\t\t() => {\r\n\t\t\tgetWeekDayTime()\r\n\t\t}\r\n\t)\r\n\r\n\tonMounted(() => {\r\n\t\tgetWeekDayTime()\r\n\t})\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.week-date {\r\n\t\t.time-list {\r\n\t\t\twidth: 90vw;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\tpadding: 20rpx;\r\n\r\n\t\t\t>.date-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tpadding: 15rpx 20rpx;\r\n\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\tfont-weight: bold;\r\n\r\n\t\t\t\t.hasC {\r\n\t\t\t\t\tposition: relative;\r\n\r\n\t\t\t\t\t&::after {\r\n\t\t\t\t\t\tcontent: \"\";\r\n\t\t\t\t\t\twidth: 15rpx;\r\n\t\t\t\t\t\theight: 15rpx;\r\n\t\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t\t\tbackground-color: red;\r\n\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\tright: -5rpx;\r\n\t\t\t\t\t\ttop: -10rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.select {\r\n\t\t\t\tbackground-color: #0497FF;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import Component from '/Users/zhangrui/Library/Mobile Documents/com~apple~CloudDocs/Desktop/桌面/WeChatApp/course-wechat/components/courseDate-weekDay/courseDate-weekDay.vue'\nwx.createComponent(Component)"],"names":["ref","prevWeekDay","monthMap","nextWeekDay","uni","watch","onMounted","Component"],"mappings":"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"}