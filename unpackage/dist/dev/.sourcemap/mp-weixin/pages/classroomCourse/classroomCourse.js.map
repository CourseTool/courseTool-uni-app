{"version":3,"file":"classroomCourse.js","sources":["pages/classroomCourse/classroomCourse.vue","pages/classroomCourse/classroomCourse.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"course\" v-if=\"isShowPage\">\n        <div class=\"course-tools\">\n            <div class=\"class\">\n                <div class=\"title\">\n                    <span style=\"text-decoration: underline\" @click=\"gotoPage('home')\">首页</span>\n                    <span @click=\"isShowSelectClassroom = true\">{{ indexData.classroom }}<span style=\"text-decoration: underline\">(更改)</span></span>\n                    <span style=\"text-decoration: underline\" @click=\"gotoCurrentDay\">今天</span>\n                </div>\n                <select-class type=\"classroom\" @hide-select-class=\"hiddenSelectClassroom\" v-if=\"isShowSelectClassroom\"></select-class>\n            </div>\n            <div class=\"week-day\">\n                <courseDate-weekDay\n                    :hasCourseList=\"hasCourseWeekDayList\"\n                    @changeWeekDay=\"changeWeekDay\"\n                    :date=\"currentDate\"\n                    v-model=\"indexData.weekDay\"\n                ></courseDate-weekDay>\n            </div>\n            <courseDate-week ref=\"weekComponent\" @selectDate=\"selectDate\" @changeWeek=\"changeWeek\" v-model=\"indexData.week\"></courseDate-week>\n        </div>\n        <div class=\"course-content\">\n            <div class=\"empty\" v-if=\"!courseData.courseList.length\">\n                <p>该教室今日无课</p>\n            </div>\n            <div v-else class=\"course-list\">\n                <div class=\"course-item\" v-for=\"data in courseData.courseList\" :key=\"data.id\">\n                    <div class=\"title\">\n                        <p>{{ data.courseSection }}</p>\n                        <p>{{ sectionTimeMap[data.courseSection] }}</p>\n                    </div>\n                    <div class=\"name\">\n                        <p>课程:</p>\n                        <span>{{ data.courseName }}</span>\n                    </div>\n                    <div class=\"teacher\">\n                        <p>教师:</p>\n                        <span>{{ data.courseTeacher }}</span>\n                    </div>\n                    <div class=\"class\">\n                        <p>班级:</p>\n                        <span>{{ data.courseClass }}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </view>\n</template>\n\n<script setup>\nimport { getCurrentDate } from \"@/uilts/time.js\";\nimport { getClassroomCourseAPI, getClassroomWeekHasCourseDayListAPI } from \"@/API/course.js\";\nimport { ref, onMounted, reactive, watch } from \"vue\";\n\nconst courseData = ref([]);\nconst sectionTimeMap = {\n    第一大节: \"8.30-10.00\",\n    第二大节: \"10.20-11.50\",\n    第三大节: \"14.00-15.30\",\n    第四大节: \"15.50-17.20\",\n    第五大节: \"18.40-20.10\",\n    第六大节: \"20.20-21.50\",\n};\n// 是否加载页面\nconst isShowPage = ref(false);\nconst isShowSelectClassroom = ref(false);\nconst currentDate = ref(new Date());\n// 查询数据\nconst indexData = reactive({});\n// 当前组件,用于触发当前日期时间更新\nconst weekComponent = ref(null);\n// 节次排序\nconst sectionSortIndex = {\n    第一大节: 1,\n    第二大节: 2,\n    第三大节: 3,\n    第四大节: 4,\n    第五大节: 5,\n    第六大节: 6,\n};\nconst hasCourseWeekDayList = ref([]);\n\nfunction selectDate(weekDay) {\n    indexData.weekDay = weekDay;\n}\n\nfunction changeWeekDay(date) {\n    weekComponent.value.setCurrentTime(date);\n}\n\nfunction gotoCurrentDay() {\n    const { week, weekDay } = getCurrentDate();\n    indexData.week = week;\n    indexData.weekDay = weekDay;\n    indexData.classroom = uni.getStorageSync(\"select-classroom\") || \"25-303M\";\n    currentDate.value = new Date();\n    const date = {\n        month: currentDate.value.getMonth() + 1,\n        day: currentDate.value.getDate(),\n    };\n    weekComponent.value.setCurrentTime(date.day, date.month);\n    weekComponent.value.getCurrentWeek();\n}\n\nfunction gotoPage(index) {\n    uni.redirectTo({\n        url: `/pages/${index}/${index}`,\n    });\n}\n\nfunction hiddenSelectClassroom(val) {\n    isShowSelectClassroom.value = false;\n    indexData.classroom = val;\n    getCourseData();\n    getWeekHasCourseDayList();\n}\n\nfunction changeWeek(newDate) {\n    currentDate.value = newDate;\n    getWeekHasCourseDayList();\n}\n\nfunction sortTeacherCourseSection() {\n    // courseData.value.courseList.sort((a, b) => {\n    //     return sectionSortIndex[a.courseSection] - sectionSortIndex[b.courseSection];\n    // });\n}\n\nasync function getCourseData() {\n    // 旧数据库\n    // const r = await getCourseDataAPI(indexData)\n    // courseData.value = r.data.data;\n    // 新数据库\n    uni.showLoading({\n        title: \"加载中...\",\n    });\n    const { data } = await getClassroomCourseAPI({\n        week: \"第\" + indexData.week + \"周\",\n        weekDay: indexData.weekDay,\n        classroom: indexData.classroom,\n    });\n    courseData.value = data.data;\n    courseData.value.courseList = Object.values(data.data.courseList);\n    sortTeacherCourseSection();\n    setTimeout(() => {\n        uni.hideLoading();\n    }, 230);\n}\n\nasync function getWeekHasCourseDayList() {\n    const data = {\n        classroom: indexData.classroom,\n        week: \"第\" + indexData.week + \"周\",\n    };\n    const res = await getClassroomWeekHasCourseDayListAPI(data);\n    hasCourseWeekDayList.value = res.data.data;\n}\n\nwatch(indexData, () => {\n    getCourseData();\n});\n\nonMounted(async () => {\n    isShowPage.value = true;\n    const { week, weekDay, weekStr } = getCurrentDate();\n    indexData.week = week;\n    indexData.weekDay = weekDay;\n    indexData.weekStr = weekStr;\n    indexData.classroom = uni.getStorageSync(\"select-classroom\") || \"25-303M\";\n    getWeekHasCourseDayList();\n});\n</script>\n\n<style lang=\"scss\">\n.course {\n    height: 100vh;\n\n    .course-tools {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-wrap: wrap;\n        flex-direction: column;\n        font-size: 28rpx;\n\n        .class {\n            width: 100vw;\n            padding: 30rpx 0;\n            display: flex;\n            align-items: center;\n            justify-content: flex-start;\n            font-weight: bold;\n            background-color: #f5f5f5;\n            letter-spacing: 1rpx;\n            cursor: pointer;\n\n            .title {\n                width: 100%;\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                padding: 0 20rpx;\n            }\n\n            > label {\n                margin: 0 10rpx;\n            }\n        }\n    }\n\n    .course-content {\n        display: flex;\n        align-items: flex-start;\n        justify-content: flex-end;\n        padding: 0 20rpx;\n        margin-top: 20rpx;\n\n        .empty {\n            width: 100vw;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            padding: 20rpx;\n            font-size: 36rpx;\n        }\n\n        .course-list {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            flex-wrap: wrap;\n\n            .course-item {\n                width: 85vw;\n                padding: 5px;\n                border-radius: 10rpx;\n                margin: 10px;\n                font-size: 30rpx;\n                background-color: #e9f3fb;\n                border: 1px solid #c3d8ee;\n\n                .title {\n                    font-size: 32rpx;\n                    color: #000;\n                    padding-bottom: 20rpx;\n                    border-bottom: 2px solid #0497ff;\n                }\n\n                > view {\n                    color: #333;\n                    margin: 10px;\n                    display: flex;\n                    align-items: flex-start;\n                    justify-content: flex-start;\n\n                    view {\n                        font-weight: bold;\n                        margin-right: 15rpx;\n                        width: fit-content;\n                        word-break: keep-all;\n                    }\n                }\n            }\n        }\n    }\n}\n</style>\n","import MiniProgramPage from '/Users/zhangrui/Library/Mobile Documents/com~apple~CloudDocs/Desktop/桌面/WeChatApp/course-wechat/pages/classroomCourse/classroomCourse.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","getCurrentDate","uni","getClassroomCourseAPI","getClassroomWeekHasCourseDayListAPI","watch","onMounted","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;AAsDA,UAAM,aAAaA,cAAAA,IAAI,CAAA,CAAE;AACzB,UAAM,iBAAiB;AAAA,MACnB,MAAM;AAAA,MACN,MAAM;AAAA,MACN,MAAM;AAAA,MACN,MAAM;AAAA,MACN,MAAM;AAAA,MACN,MAAM;AAAA,IACV;AAEA,UAAM,aAAaA,cAAAA,IAAI,KAAK;AAC5B,UAAM,wBAAwBA,cAAAA,IAAI,KAAK;AACvC,UAAM,cAAcA,cAAG,IAAC,oBAAI,KAAI,CAAE;AAElC,UAAM,YAAYC,cAAAA,SAAS,CAAA,CAAE;AAE7B,UAAM,gBAAgBD,cAAAA,IAAI,IAAI;AAU9B,UAAM,uBAAuBA,cAAAA,IAAI,CAAA,CAAE;AAEnC,aAAS,WAAW,SAAS;AACzB,gBAAU,UAAU;AAAA,IACxB;AAEA,aAAS,cAAc,MAAM;AACzB,oBAAc,MAAM,eAAe,IAAI;AAAA,IAC3C;AAEA,aAAS,iBAAiB;AACtB,YAAM,EAAE,MAAM,QAAS,IAAGE,WAAc,eAAA;AACxC,gBAAU,OAAO;AACjB,gBAAU,UAAU;AACpB,gBAAU,YAAYC,cAAG,MAAC,eAAe,kBAAkB,KAAK;AAChE,kBAAY,QAAQ,oBAAI;AACxB,YAAM,OAAO;AAAA,QACT,OAAO,YAAY,MAAM,SAAU,IAAG;AAAA,QACtC,KAAK,YAAY,MAAM,QAAS;AAAA,MACxC;AACI,oBAAc,MAAM,eAAe,KAAK,KAAK,KAAK,KAAK;AACvD,oBAAc,MAAM;IACxB;AAEA,aAAS,SAAS,OAAO;AACrBA,oBAAAA,MAAI,WAAW;AAAA,QACX,KAAK,UAAU,KAAK,IAAI,KAAK;AAAA,MACrC,CAAK;AAAA,IACL;AAEA,aAAS,sBAAsB,KAAK;AAChC,4BAAsB,QAAQ;AAC9B,gBAAU,YAAY;AACtB;AACA;IACJ;AAEA,aAAS,WAAW,SAAS;AACzB,kBAAY,QAAQ;AACpB;IACJ;AAQA,mBAAe,gBAAgB;AAK3BA,oBAAAA,MAAI,YAAY;AAAA,QACZ,OAAO;AAAA,MACf,CAAK;AACD,YAAM,EAAE,SAAS,MAAMC,iCAAsB;AAAA,QACzC,MAAM,MAAM,UAAU,OAAO;AAAA,QAC7B,SAAS,UAAU;AAAA,QACnB,WAAW,UAAU;AAAA,MAC7B,CAAK;AACD,iBAAW,QAAQ,KAAK;AACxB,iBAAW,MAAM,aAAa,OAAO,OAAO,KAAK,KAAK,UAAU;AAEhE,iBAAW,MAAM;AACbD,sBAAG,MAAC,YAAW;AAAA,MAClB,GAAE,GAAG;AAAA,IACV;AAEA,mBAAe,0BAA0B;AACrC,YAAM,OAAO;AAAA,QACT,WAAW,UAAU;AAAA,QACrB,MAAM,MAAM,UAAU,OAAO;AAAA,MACrC;AACI,YAAM,MAAM,MAAME,+CAAoC,IAAI;AAC1D,2BAAqB,QAAQ,IAAI,KAAK;AAAA,IAC1C;AAEAC,kBAAK,MAAC,WAAW,MAAM;AACnB;IACJ,CAAC;AAEDC,kBAAAA,UAAU,YAAY;AAClB,iBAAW,QAAQ;AACnB,YAAM,EAAE,MAAM,SAAS,QAAS,IAAGL,WAAc,eAAA;AACjD,gBAAU,OAAO;AACjB,gBAAU,UAAU;AACpB,gBAAU,UAAU;AACpB,gBAAU,YAAYC,cAAG,MAAC,eAAe,kBAAkB,KAAK;AAChE;IACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzKD,GAAG,WAAWK,SAAe;"}