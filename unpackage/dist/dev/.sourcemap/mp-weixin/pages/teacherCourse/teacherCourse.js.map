{"version":3,"file":"teacherCourse.js","sources":["pages/teacherCourse/teacherCourse.vue","pages/teacherCourse/teacherCourse.vue?type=page"],"sourcesContent":["<template>\n\t<view class='course' v-if=\"isShowPage\">\n\t\t<div class=\"course-tools\">\n\t\t\t<div class=\"class\">\n\t\t\t\t<div class=\"title\">\n\t\t\t\t\t<span style='text-decoration: underline;' @click=\"gotoPage('home')\">首页</span>\n\t\t\t\t\t<span @click=\"isShowSelectTeacher=true\">{{indexData.teacherName}}<span\n\t\t\t\t\t\t\tstyle=\"text-decoration: underline;\">(更改)</span></span>\n\t\t\t\t\t<span style='text-decoration: underline;' @click=\"gotoCurrentDay\">今天</span>\n\t\t\t\t</div>\n\t\t\t\t<select-class type=\"teacher\" @hide-select-class=\"hiddenSelectTeacher\"\n\t\t\t\t\tv-if=\"isShowSelectTeacher\"></select-class>\n\t\t\t</div>\n\t\t\t<div class=\"week-day\">\n\t\t\t\t<courseDate-weekDay ref='weekDayComponent' :hasCourseList=\"hasCourseWeekDayList\"\n\t\t\t\t\t@changeWeekDay=\"changeWeekDay\" :date=\"currentDate\" v-model=\"indexData.weekDay\"></courseDate-weekDay>\n\t\t\t</div>\n\t\t\t<courseDate-week ref=\"weekComponent\" @selectDate=\"selectDate\" @changeWeek=\"changeWeek\"\n\t\t\t\tv-model=\"indexData.week\"></courseDate-week>\n\t\t</div>\n\t\t<div @touchstart=\"touchStart\" @touchend='silder' class=\"course-content\">\n\t\t\t<div class=\"empty\" v-if=\"courseData.length === 0\">\n\t\t\t\t<p>老师,您今天没课哦</p>\n\t\t\t</div>\n\t\t\t<div v-else class=\"course-list\">\n\t\t\t\t<div class=\"course-item\" v-for='data in courseData.courseList' :key='data.id'>\n\t\t\t\t\t<div class=\"title\">\n\t\t\t\t\t\t<p>{{data.courseSection}}</p>\n\t\t\t\t\t\t<p>{{sectionTimeMap[data.courseSection]}}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"name\">\n\t\t\t\t\t\t<p>课程:</p>\n\t\t\t\t\t\t<span>{{data.courseName}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"position\">\n\t\t\t\t\t\t<p>地点:</p>\n\t\t\t\t\t\t<span>{{data.coursePosition}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"teacher\">\n\t\t\t\t\t\t<p>班级:</p>\n\t\t\t\t\t\t<span>{{data.courseClass}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</view>\n</template>\n\n<script setup>\n\timport {\n\t\tgetCurrentDate,\n\t\tmonthMap\n\t} from \"@/uilts/time.js\"\n\timport {\n\t\tgetTeacherCourseAPI,\n\t\tgetTeacherWeekHasCourseDayListAPI\n\t} from '@/API/course.js'\n\timport {\n\t\tref,\n\t\tonMounted,\n\t\treactive,\n\t\twatch\n\t} from 'vue'\n\n\tconst courseData = ref({\n\t\tcourseList: []\n\t})\n\tconst sectionTimeMap = {\n\t\t\"第一大节\": \"8.30-10.00\",\n\t\t\"第二大节\": \"10.20-11.50\",\n\t\t\"第三大节\": \"14.00-15.30\",\n\t\t\"第四大节\": \"15.50-17.20\",\n\t\t\"第五大节\": \"18.40-20.10\",\n\t\t\"第六大节\": \"20.20-21.50\"\n\t}\n\t// 是否加载页面\n\tconst isShowPage = ref(false)\n\tconst isShowSelectTeacher = ref(false)\n\tconst currentDate = ref(new Date())\n\t// 查询数据\n\tconst indexData = reactive({})\n\t// 当前组件,用于触发当前日期时间更新\n\tconst weekComponent = ref(null)\n\tconst weekDayComponent = ref(null)\n\tconst hasCourseWeekDayList = ref([])\n\tconst touchStartX = ref(0)\n\n\tconst sectionSortIndex = {\n\t\t\"第一大节\": 1,\n\t\t\"第二大节\": 2,\n\t\t\"第三大节\": 3,\n\t\t\"第四大节\": 4,\n\t\t\"第五大节\": 5,\n\t\t\"第六大节\": 6,\n\t}\n\n\tfunction sortCourseSection() {\n\t\tif (courseData.value.length === 0) return\n\t\tconst sortObj = {}\n\t\tconst sortIndex = Object.keys(courseData.value.courseList).sort((a, b) => sectionSortIndex[a] - sectionSortIndex[\n\t\t\tb])\n\t\tfor (let k of sortIndex) {\n\t\t\tsortObj[k] = courseData.value.courseList[k]\n\t\t}\n\t\tcourseData.value.courseList = sortObj\n\t}\n\n\t// function silder(e) {\n\t// \tlet deltaX = e.changedTouches[0].clientX - touchStartX.value;\n\t// \tif (Math.abs(deltaX) > 50) {\n\t// \t\tconsole.log(indexData)\n\t// \t\tif (deltaX >= 0) {\n\t// \t\t\tif (currentDate.value.getDate() === 1) {\n\t// \t\t\t\tuni.showToast({\n\t// \t\t\t\t\ttitle: \"暂不支持切换\",\n\t// \t\t\t\t\ticon: 'error'\n\t// \t\t\t\t})\n\t// \t\t\t\treturn\n\t// \t\t\t}\n\n\t// \t\t\tif (indexData.weekDay === '星期一') {\n\t// \t\t\t\tweekComponent.value.prevWeek()\n\t// \t\t\t}\n\t// \t\t\tweekDayComponent.value.prevWeekDay()\n\n\t// \t\t} else {\n\t// \t\t\tconst month = currentDate.value.getMonth() + 1\n\t// \t\t\tif (currentDate.value.getDate() === monthMap[month]) {\n\t// \t\t\t\t// const newDate = new Date()\n\t// \t\t\t\t// newDate.setDate(1)\n\t// \t\t\t\t// newDate.setMonth(newDate.getMonth() + 1)\n\t// \t\t\t\t// currentDate.value = newDate\n\t// \t\t\t\t// const date = {\n\t// \t\t\t\t// \tday: newDate.getDate(),\n\t// \t\t\t\t// \tmonth: newDate.getMonth() + 1\n\t// \t\t\t\t// }\n\t// \t\t\t\t// changeWeekDay(date)\n\t// \t\t\t\t// return\n\t// \t\t\t\tuni.showToast({\n\t// \t\t\t\t\ttitle: \"暂不支持切换\",\n\t// \t\t\t\t\ticon: 'error'\n\t// \t\t\t\t})\n\t// \t\t\t\treturn\n\t// \t\t\t}\n\t// \t\t\tif (indexData.weekDay === '星期日') {\n\t// \t\t\t\tweekComponent.value.nextWeek()\n\t// \t\t\t}\n\t// \t\t\tweekDayComponent.value.nextWeekDay()\n\t// \t\t}\n\t// \t}\n\t// }\n\n\tfunction selectDate(weekDay) {\n\t\tindexData.weekDay = weekDay\n\t}\n\n\tfunction changeWeekDay(date) {\n\t\t// const newDate = new Date()\n\t\t// newDate.setDate(date.day)\n\t\t// currentDate.value = newDate\n\t\tweekComponent.value.setCurrentTime(date)\n\t}\n\n\tfunction gotoCurrentDay() {\n\t\tconst {\n\t\t\tweek,\n\t\t\tweekDay\n\t\t} = getCurrentDate()\n\t\tindexData.week = week\n\t\tindexData.weekDay = weekDay\n\t\tindexData.teacherName = uni.getStorageSync(\"home-active-type\") === \"teacher\" ? uni.getStorageSync(\n\t\t\t\"home-active-val\") : \"吴宇飞\"\n\t\tcurrentDate.value = new Date()\n\t\tconst date = {\n\t\t\tmonth: currentDate.value.getMonth() + 1,\n\t\t\tday: currentDate.value.getDate()\n\t\t}\n\t\tweekComponent.value.setCurrentTime(date)\n\t\tweekComponent.value.getCurrentWeek()\n\t}\n\n\tfunction gotoPage(index) {\n\t\tuni.redirectTo({\n\t\t\turl: `/pages/${index}/${index}`\n\t\t})\n\t}\n\n\tfunction hiddenSelectTeacher(val) {\n\t\tisShowSelectTeacher.value = false\n\t\tindexData.teacherName = val\n\t\tuni.setStorageSync(\"home-active-type\", \"teacher\")\n\t\tuni.setStorageSync(\"home-active-val\", val)\n\t\tgetTeacherCourseAPI()\n\t\tgetWeekHasCourseDayList()\n\t}\n\n\n\tfunction changeWeek(newDate) {\n\t\tcurrentDate.value = newDate\n\t\tgetWeekHasCourseDayList()\n\t}\n\n\t// function sortTeacherCourseSection() {\n\t// \tcourseData.value.courseList.sort((a, b) => {\n\t// \t\treturn sectionSortIndex[a.courseSection] - sectionSortIndex[b.courseSection]\n\t// \t})\n\t// }\n\n\tasync function getCourseData() {\n\t\t// 旧数据库\n\t\t// const r = await getCourseDataAPI(indexData)\n\t\t// courseData.value = r.data.data;\n\t\t// 新数据库\n\t\tuni.showLoading({\n\t\t\ttitle: \"加载中...\",\n\t\t})\n\t\tconst weekStr = `第${indexData.week}周`\n\t\t\n\t\tconst {\n\t\t\tdata\n\t\t} = await getTeacherCourseAPI({\n\t\t\tteacherName:indexData.teacherName,\n\t\t\tweekDay:indexData.weekDay,\n\t\t\tweek:weekStr\n\t\t})\n\t\tcourseData.value = data.data\n\t\tsortCourseSection()\n\t\tsetTimeout(() => {\n\t\t\tuni.hideLoading()\n\t\t}, 230)\n\t}\n\tasync function getWeekHasCourseDayList() {\n\t\tconst weekStr = `第${indexData.week}周`\n\t\t\n\t\tconst data = {\n\t\t\tteacher: indexData.teacherName,\n\t\t\tweek:weekStr\n\t\t}\n\t\tconst res = await getTeacherWeekHasCourseDayListAPI(data)\n\t\thasCourseWeekDayList.value = res.data.data\n\t}\n\n\twatch(indexData, () => {\n\t\tgetCourseData()\n\t})\n\n\tonMounted(async () => {\n\t\tisShowPage.value = true\n\t\tconst {\n\t\t\tweek,\n\t\t\tweekDay\n\t\t} = getCurrentDate()\n\t\tindexData.week = week\n\t\tindexData.weekDay = weekDay\n\t\tindexData.teacherName = uni.getStorageSync(\"home-active-type\") === \"teacher\" ? uni.getStorageSync(\n\t\t\t\"home-active-val\") : \"吴宇飞\"\n\t\tgetWeekHasCourseDayList()\n\t})\n</script>\n\n<style lang=\"scss\">\n\t.course {\n\t\theight: 100vh;\n\t\toverflow-x: hidden;\n\n\t\t.course-tools {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\tflex-wrap: wrap;\n\t\t\tflex-direction: column;\n\t\t\tfont-size: 28rpx;\n\n\t\t\t.class {\n\t\t\t\twidth: 100vw;\n\t\t\t\tpadding: 30rpx 0;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: flex-start;\n\t\t\t\tfont-weight: bold;\n\t\t\t\tbackground-color: #f5f5f5;\n\t\t\t\tletter-spacing: 1rpx;\n\t\t\t\tcursor: pointer;\n\n\t\t\t\t.title {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\tpadding: 0 20rpx;\n\t\t\t\t}\n\n\t\t\t\t>label {\n\t\t\t\t\tmargin: 0 10rpx;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.course-content {\n\t\t\twidth: 95%;\n\t\t\theight: 80vh;\n\t\t\tdisplay: flex;\n\t\t\talign-items: flex-start;\n\t\t\tjustify-content: flex-end;\n\t\t\tmargin: 0 auto;\n\t\t\tmargin-top: 20rpx;\n\n\t\t\t.empty {\n\t\t\t\twidth: 100vw;\n\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: flex-start;\n\t\t\t\tjustify-content: center;\n\t\t\t\tpadding: 20rpx;\n\t\t\t\tfont-size: 36rpx;\n\t\t\t}\n\n\t\t\t.course-list {\n\t\t\t\twidth: 100%;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t\tflex-wrap: wrap;\n\n\t\t\t\t.course-item {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tpadding: 5px;\n\t\t\t\t\tborder-radius: 10rpx;\n\t\t\t\t\tmargin: 10px;\n\t\t\t\t\tfont-size: 30rpx;\n\t\t\t\t\tbackground-color: #e9f3fb;\n\t\t\t\t\tborder: 1px solid #c3d8ee;\n\n\t\t\t\t\t.title {\n\t\t\t\t\t\tfont-size: 34rpx;\n\t\t\t\t\t\tcolor: #000;\n\t\t\t\t\t\tpadding-bottom: 20rpx;\n\t\t\t\t\t\tborder-bottom: 2px solid #0497FF;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t}\n\n\t\t\t\t\t>view {\n\t\t\t\t\t\tcolor: #333;\n\t\t\t\t\t\tmargin: 10px;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\talign-items: flex-start;\n\t\t\t\t\t\tjustify-content: flex-start;\n\n\t\t\t\t\t\tview {\n\t\t\t\t\t\t\tfont-weight: bolder;\n\t\t\t\t\t\t\tmargin-right: 15rpx;\n\t\t\t\t\t\t\tcolor: #333;\n\t\t\t\t\t\t\twidth: fit-content;\n\t\t\t\t\t\t\tword-break: keep-all;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n</style>","import MiniProgramPage from '/Users/zhangrui/Library/Mobile Documents/com~apple~CloudDocs/Desktop/桌面/WeChatApp/course-wechat/pages/teacherCourse/teacherCourse.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","getCurrentDate","uni","getTeacherCourseAPI","getTeacherWeekHasCourseDayListAPI","watch","onMounted","MiniProgramPage"],"mappings":"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"}