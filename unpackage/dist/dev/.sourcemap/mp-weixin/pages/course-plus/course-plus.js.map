{"version":3,"file":"course-plus.js","sources":["pages/course-plus/course-plus.vue","pages/course-plus/course-plus.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"course-plus\" :class=\"{ grid: currentShowType.value === 'grid' }\" v-if=\"isShowPage\">\n        <div class=\"header\">\n            <div class=\"right-week\">\n                <picker @change=\"changeWeek\" :value=\"weekIndex\" :range=\"weekList\">\n                    <view class=\"uni-input\">{{ weekList[weekIndex] }}<uni-icons color=\"#fff\" type=\"down\" size=\"22\"></uni-icons> </view>\n                </picker>\n            </div>\n            <div @click=\"isShowSelectClass = true\" class=\"center-class\">\n                <p style=\"text-decoration: underline\">{{ indexData.className }}(更改)</p>\n            </div>\n            <!-- <div @click=\"gotoCurrent\" style=\"text-decoration: underline;\" class=\"right-reset\">\n\t\t\t\t<p>今天</p>\n\t\t\t</div> -->\n            <div class=\"right-select-ui\" style=\"text-decoration: underline\">\n                <picker mode=\"selector\" :range=\"uiList.map(d => d.title)\" @change=\"changeUi\">\n                    <view>{{ currentShowType.title }}</view>\n                </picker>\n            </div>\n            <select-class type=\"student\" @hide-select-class=\"hiddenSelectClass\" v-if=\"isShowSelectClass\"></select-class>\n        </div>\n        <div class=\"course-calendar\">\n            <div class=\"top-week-day\">\n                <div class=\"month\" style=\"width: 50rpx; white-space: nowrap\">\n                    <p>{{ month }}月</p>\n                </div>\n                <div class=\"week-day-item\" v-for=\"d in weekDayList\">\n                    <p>{{ d.weekDay }}</p>\n                    <p>{{ d.day }}</p>\n                </div>\n            </div>\n            <div class=\"content-main\">\n                <div class=\"left-section\">\n                    <div class=\"section-item\">\n                        <p>一</p>\n                        <p>8.30</p>\n                        <p>|</p>\n                        <p>10.00</p>\n                    </div>\n                    <div class=\"section-item\">\n                        <p>二</p>\n                        <p>10.20</p>\n                        <p>|</p>\n                        <p>11.50</p>\n                    </div>\n                    <div class=\"section-item\">\n                        <p>三</p>\n                        <p>14.00</p>\n                        <p>|</p>\n                        <p>15.30</p>\n                    </div>\n                    <div class=\"section-item\">\n                        <p>四</p>\n                        <p>15.50</p>\n                        <p>|</p>\n                        <p>17.20</p>\n                    </div>\n                    <div class=\"section-item\">\n                        <p>五</p>\n                        <p>18.40</p>\n                        <p>|</p>\n                        <p>20.10</p>\n                    </div>\n                    <div class=\"section-item\">\n                        <p>六</p>\n                        <p>20.20</p>\n                        <p>|</p>\n                        <p>21.50</p>\n                    </div>\n                </div>\n                <div class=\"right-course-list\">\n                    <div v-for=\"data in weekCourseList\" class=\"course-list one\">\n                        <course-plus-item :type=\"currentShowType.value\" :data=\"d\" v-for=\"d in data.courseList\" :key=\"d.id\"></course-plus-item>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </view>\n</template>\n\n<script setup>\nimport { getCourseForWeekAPI } from \"@/API/course.js\";\nimport { ref, onMounted, watch } from \"vue\";\nimport { getCurrentDate, getDateByWeek, getMonthByWeek } from \"@/uilts/time.js\";\n\nconst isShowPage = ref(false);\nconst weekCourseList = ref([]);\nconst indexData = ref({\n    className: \"\",\n    week: \"\",\n});\nconst isShowSelectClass = ref(false);\nconst weekList = ref([]);\nconst weekIndex = ref(0);\nconst weekDayList = ref([]);\nconst uiList = [\n    {\n        value: \"list\",\n        title: \"列表\",\n    },\n    {\n        value: \"grid\",\n        title: \"网格\",\n    },\n];\nconst currentShowType = ref(uiList[1]);\nconst month = ref(0);\n\nconst sectionMap = [\"第一大节\", \"第二大节\", \"第三大节\", \"第四大节\", \"第五大节\", \"第六大节\"];\nconst sectionSortIndex = {\n    第一大节: 1,\n    第二大节: 2,\n    第三大节: 3,\n    第四大节: 4,\n    第五大节: 5,\n    第六大节: 6,\n};\n\nfunction changeUi(e) {\n    currentShowType.value = uiList.find(d => d.title === uiList[+e.detail.value].title);\n    getCourseData();\n}\n\n// function gotoCurrent() {\n// \tconst {\n// \t\tweek,\n// \t} = getCurrentDate()\n// \tindexData.value.week = week\n// \tweekIndex.value = weekList.value.indexOf(week)\n// \tweekDayList.value = getDateByWeek(weekIndex.value + 1)\n// }\n\nfunction changeWeek(e) {\n    weekIndex.value = e.detail.value;\n    indexData.value.week = weekList.value[weekIndex.value];\n    weekDayList.value = getDateByWeek(+weekIndex.value + 1);\n    month.value = getMonthByWeek(weekIndex.value);\n}\n\nfunction initWeekList() {\n    for (let i = 1; i <= 25; i++) {\n        weekList.value.push(\"第\" + i + \"周\");\n    }\n    const { weekStr } = getCurrentDate();\n    indexData.value.week = weekStr;\n    weekIndex.value = weekList.value.indexOf(weekStr);\n}\n\nfunction hiddenSelectClass(val) {\n    indexData.value.className = val;\n    isShowSelectClass.value = false;\n    getCourseData();\n    uni.setStorageSync(\"home-active-type\", \"student\");\n    uni.setStorageSync(\"home-active-val\", val);\n}\n\nfunction fillCourseList() {\n    if (weekCourseList.value.length === 0) {\n        weekCourseList.value = new Array(7).fill({\n            courseList: {},\n        });\n        weekCourseList.value.forEach(d => {\n            sectionMap.forEach(s => {\n                d.courseList[s] = {\n                    isEmpty: true,\n                    courseSection: s,\n                };\n            });\n        });\n    }\n    weekCourseList.value.forEach(d => {\n        const sectionList = Object.keys(d.courseList);\n        sectionMap.forEach(s => {\n            if (!sectionList.includes(s)) {\n                d.courseList[s] = {\n                    isEmpty: true,\n                    courseSection: s,\n                };\n            }\n        });\n    });\n}\n\nfunction gropCourseList() {\n    function _isSame(d, c) {\n        return d.courseName === c.courseName && sectionSortIndex[d.courseSection] - sectionSortIndex[c.courseSection] === -1;\n    }\n    weekCourseList.value.forEach(d => {\n        let prevCourse = null;\n        for (let k in d.courseList) {\n            if (!prevCourse) {\n                prevCourse = d.courseList[k];\n                continue;\n            }\n            const c = d.courseList[k];\n            if (_isSame(prevCourse, c)) {\n                delete d.courseList[k];\n                prevCourse[\"isContinuous\"] = true;\n                d.courseList[k] = prevCourse;\n            } else {\n                prevCourse = d.courseList[k];\n            }\n        }\n    });\n}\n\nasync function getCourseData() {\n    uni.showLoading({\n        title: \"加载中....\",\n    });\n    weekCourseList.value = [];\n    const res = await getCourseForWeekAPI(indexData.value);\n    weekCourseList.value = res.data.data;\n    if (currentShowType.value.value === \"list\") {\n        fillCourseList();\n    } else {\n        gropCourseList();\n    }\n    setTimeout(() => {\n        uni.hideLoading();\n        isShowPage.value = true;\n    }, 150);\n}\n\nwatch(indexData.value, () => {\n    getCourseData();\n});\n\nonMounted(() => {\n    initWeekList();\n    indexData.value.className = uni.getStorageSync(\"home-active-type\") === \"student\" ? uni.getStorageSync(\"home-active-val\") : \"软件2303班\";\n    weekDayList.value = getDateByWeek(weekIndex.value + 1);\n    month.value = getMonthByWeek(weekIndex.value);\n});\n</script>\n\n<style lang=\"scss\">\n.course-plus {\n    overflow-x: hidden;\n\n    .header {\n        padding: 20rpx;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        font-size: 30rpx;\n        font-weight: bold;\n\n        .right-week {\n            width: 190rpx;\n            height: 70rpx;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            background-color: #0497ff;\n            color: #fff;\n            border-radius: 20rpx;\n\n            :deep(.uni-input) {\n                display: flex;\n                align-items: center;\n                justify-content: center;\n            }\n\n            :deep(.uniui-down) {\n                margin-left: 10rpx;\n            }\n\n            view {\n                margin-right: 20rpx;\n            }\n        }\n    }\n}\n\n.course-calendar {\n    margin-top: 10rpx;\n\n    .top-week-day {\n        background-color: #fafafa;\n        padding: 10rpx;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        font-size: 24rpx;\n        color: #333;\n\n        .week-day-item {\n            width: 110rpx;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            flex-direction: column;\n        }\n    }\n\n    .content-main {\n        padding: 10rpx;\n        padding-top: 0;\n        display: flex;\n        align-items: flex-start;\n        justify-content: flex-start;\n\n        .left-section {\n            font-size: 18rpx;\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            flex-direction: column;\n            margin-right: 10rpx;\n            height: 90vh;\n\n            view {\n                text-align: center;\n            }\n\n            .section-item {\n                margin-top: 70rpx;\n\n                view:first-child {\n                    font-size: 22rpx;\n                    font-weight: bolder;\n                }\n            }\n        }\n\n        .right-course-list {\n            width: 90vw;\n            position: relative;\n            display: flex;\n            align-items: center;\n            justify-content: flex-start;\n            height: 95vh;\n\n            .course-list {\n                width: 110rpx;\n                height: 100%;\n                position: relative;\n            }\n        }\n    }\n}\n\n.grid .course-calendar {\n    .content-main {\n        .left-section {\n            height: 95vh;\n            justify-content: center;\n\n            .section-item {\n                height: 17%;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                flex-direction: column;\n                position: relative;\n                margin: 0 !important;\n            }\n\n            .section-item::after {\n                content: \"\";\n                width: 100vw;\n                height: 100%;\n                border-top: 2rpx dashed #ccc;\n                border-bottom: 2rpx dashed #ccc;\n                position: absolute;\n                right: -101vw;\n                top: 0;\n                z-index: 100;\n            }\n        }\n\n        .right-course-list {\n            .course-list {\n                border-right: 2rpx dashed #ccc;\n\n                &:last-child {\n                    border-right: none;\n                }\n            }\n        }\n    }\n}\n</style>\n","import MiniProgramPage from '/Users/zhangrui/Library/Mobile Documents/com~apple~CloudDocs/Desktop/桌面/WeChatApp/course-wechat/pages/course-plus/course-plus.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","getDateByWeek","getMonthByWeek","getCurrentDate","uni","getCourseForWeekAPI","watch","onMounted","MiniProgramPage"],"mappings":"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"}