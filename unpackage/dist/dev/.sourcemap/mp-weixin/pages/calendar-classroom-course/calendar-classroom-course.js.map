{"version":3,"file":"calendar-classroom-course.js","sources":["pages/calendar-classroom-course/calendar-classroom-course.vue","pages/calendar-classroom-course/calendar-classroom-course.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"calendar-classroom-course\" v-if=\"isShowPage\">\n\t\t<div @click=\"isShowSelectClassroom = true\" class=\"header\">\n\t\t\t<p style=\"text-decoration: underline;\">当前教室:{{indexData.classroom}}更改</p>\n\t\t</div>\n\t\t<select-class v-if=\"isShowSelectClassroom\" type='classroom' @hide-select-class=\"selectClassroom\"></select-class>\n\t\t<uni-calendar @monthSwitch=\"changeMonth\" :selected=\"fillCourseDayList\" :insert=\"true\" :lunar=\"true\"\n\t\t\t:start-date=\"semesterDate.start_date\" :end-date=\"semesterDate.end_date\" @change=\"changeDate\" />\n\t\t<div class=\"course-list\">\n\t\t\t<div class=\"title\">\n\t\t\t\t<p>{{indexData.week}} {{indexData.weekDay}} 课程列表</p>\n\t\t\t</div>\n\t\t\t<div v-if=\"courseDataList.length !== 0\" class=\"course-item\" v-for=\"d in courseDataList\" :key=\"d.id\">\n\t\t\t\t<div class=\"left-index\">\n\t\t\t\t\t<div class=\"section\">\n\t\t\t\t\t\t<p>{{d.courseSection}}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"time\">\n\t\t\t\t\t\t<p>{{timeStampMap[d.courseSection].replace(\" \",\"-\")}}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"right-course\">\n\t\t\t\t\t<div class=\"name\">\n\t\t\t\t\t\t<p class=\"title\">课程:</p>\n\t\t\t\t\t\t<p class=\"value\">{{d.courseName}}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"position\">\n\t\t\t\t\t\t<p class=\"title\">老师:</p>\n\t\t\t\t\t\t<p class=\"value\">{{d.courseTeacher}}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"class\">\n\t\t\t\t\t\t<p class=\"title\">班级:</p>\n\t\t\t\t\t\t<p class=\"value\">{{d.courseClass}}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"empty\" v-else>\n\t\t\t\t<p>今日无课</p>\n\t\t\t</div>\n\t\t</div>\n\t</view>\n</template>\n\n<script setup>\n\timport {\n\t\treactive,\n\t\tref,\n\t\tonMounted\n\t} from 'vue'\n\timport {\n\t\tgetCurrentDate,\n\t\ttimeStampMap,\n\t\tmonthMap,\n\t\tgetDateByWeekandWeekDay\n\t} from '@/uilts/time.js'\n\timport {\n\t\tgetClassroomCourseAPI,\n\t\tgetClassroomCourseForCalendarAPI\n\t} from '@/API/course.js'\n\timport {\n\t\tgetCourseConfigAPISync\n\t} from '../../API/config';\n\n\tconst isShowSelectClassroom = ref(false)\n\tconst courseDataList = ref([])\n\tconst isShowPage = ref(false)\n\tconst indexData = reactive({\n\t\tmonth: \"\",\n\t\tteacher: \"\",\n\t\tday: \"\",\n\t\tweek: \"\",\n\t\tweekDay: \"\"\n\t})\n\tconst fillCourseDayList = ref([])\n\tlet hasCourseDayList = []\n\tconst calendarWeekList = ref([])\n\tconst calendarCourseDataList = ref([])\n\tconst currentMonth = ref(\"\")\n\tconst currentDay = ref(\"\")\n\tconst sectionSortIndex = {\n\t\t\"第一大节\": 1,\n\t\t\"第二大节\": 2,\n\t\t\"第三大节\": 3,\n\t\t\"第四大节\": 4,\n\t\t\"第五大节\": 5,\n\t\t\"第六大节\": 6,\n\t}\n\tconst semesterDate = ref({})\n\n\n\tfunction sortCourseSection(courseList) {\n\t\tcourseList.sort((a, b) => {\n\t\t\treturn sectionSortIndex[a.courseSection] - sectionSortIndex[b.courseSection]\n\t\t})\n\t}\n\n\tfunction selectClassroom(val) {\n\t\tindexData.classroom = val\n\t\tisShowSelectClassroom.value = false\n\t\t// updateDate()\n\t\tgetCourse()\n\t\tgetMonthCourse()\n\t}\n\n\tfunction changeMonth(e) {\n\t\tindexData.month = e.month\n\t\tindexData.year = e.year\n\t\tcurrentMonth.value = e.month\n\t\tcurrentDay.value = 1\n\t\tgetMonthCourse()\n\t}\n\n\tasync function getMonthCourse() {\n\t\tuni.showLoading({\n\t\t\ttitle: \"加载中...\"\n\t\t})\n\t\tawait getCourseForCalendar()\n\t\tfillCalendar()\n\t\tuni.hideLoading()\n\t\tisShowPage.value = true\n\t}\n\n\tasync function getCourse() {\n\t\tuni.showLoading({\n\t\t\ttitle: \"加载中...\"\n\t\t})\n\t\tconst {\n\t\t\tclassroom,\n\t\t\tweek,\n\t\t\tweekDay\n\t\t} = indexData\n\t\tconst res = await getClassroomCourseAPI({\n\t\t\tclassroom: classroom,\n\t\t\tweek,\n\t\t\tweekDay\n\t\t})\n\t\tcourseDataList.value = res.data.data\n\t\tsortCourseSection(courseDataList.value)\n\t\tsetTimeout(() => {\n\t\t\tuni.hideLoading()\n\t\t}, 100)\n\t}\n\n\tfunction changeDate(e) {\n\t\tindexData.month = +e.month\n\t\tindexData.day = e.date\n\t\tconst {\n\t\t\tweekDay,\n\t\t\tweek\n\t\t} = getCurrentDate(indexData);\n\t\tindexData.week = week\n\t\tindexData.weekDay = weekDay\n\t\tgetCourse()\n\t}\n\n\tasync function getCourseForCalendar() {\n\t\thasCourseDayList = []\n\t\tgenMonthWeek()\n\t\tconst data = {\n\t\t\tweekList: calendarWeekList.value,\n\t\t\tclassroom: indexData.classroom\n\t\t}\n\t\tconst res = await getClassroomCourseForCalendarAPI(data)\n\t\tcalendarCourseDataList.value = res.data.data\n\t\tcalendarCourseDataList.value.forEach(d => {\n\t\t\tconst date = {\n\t\t\t\tweek: d.week,\n\t\t\t\tweekDay: d.courseWeekDay\n\t\t\t}\n\t\t\tconst r = getDateByWeekandWeekDay(date)\n\t\t\thasCourseDayList.push(r);\n\t\t})\n\t}\n\n\tfunction genMonthWeek() {\n\t\tcalendarWeekList.value = []\n\t\tconst month = indexData.month\n\t\tfor (let i = 1; i <= monthMap[month]; i++) {\n\t\t\tconst {\n\t\t\t\tweek\n\t\t\t} = getCurrentDate({\n\t\t\t\tday: i,\n\t\t\t\tmonth: indexData.month\n\t\t\t})\n\t\t\tif (!calendarWeekList.value.includes(week)) {\n\t\t\t\tcalendarWeekList.value.push(week)\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction fillCalendar() {\n\t\tconst fillList = []\n\t\tconst month = indexData.month\n\t\tfor (let i = 1; i <= monthMap[month]; i++) {\n\t\t\tconst m = month.toString().padStart(2, 0)\n\t\t\tconst day = i\n\t\t\tconst d = `${indexData.year}-${m}-${day}`\n\t\t\tconsole.log(d, hasCourseDayList);\n\t\t\tif (hasCourseDayList.includes(d)) {\n\t\t\t\tfillList.push({\n\t\t\t\t\tdate: d,\n\t\t\t\t\tinfo: \"有课\",\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tfillCourseDayList.value = fillList\n\t}\n\n\tfunction updateDate() {\n\t\tconst date = {\n\t\t\tmonth: currentMonth.value,\n\t\t\tday: currentDay.value\n\t\t}\n\t\tconst {\n\t\t\tweek,\n\t\t\tweekDay\n\t\t} = getCurrentDate(date)\n\t\tindexData.week = week\n\t\tindexData.weekDay = weekDay\n\t}\n\n\tonMounted(async () => {\n\t\tindexData.classroom = \"25-303M\"\n\t\tconst date = new Date()\n\t\tconst month = date.getMonth() + 1\n\t\tconst day = date.getDate()\n\t\tconst year = date.getFullYear()\n\t\tindexData.month = month\n\t\tindexData.day = day\n\t\tindexData.year = year\n\t\tcurrentMonth.value = month\n\t\tcurrentDay.value = day\n\t\tupdateDate()\n\t\tgetCourse()\n\t\tgetMonthCourse()\n\t\tconst data = getCourseConfigAPISync()\n\t\tsemesterDate.value = data\n\t})\n</script>\n\n<style lang=\"scss\">\n\t.header {\n\t\tpadding: 20rpx;\n\t\tfont-size: 40rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #6598d9;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tletter-spacing: 2rpx;\n\t}\n\n\t.course-list {\n\t\tmargin: 0 auto;\n\t\tpadding: 20rpx 0;\n\t\twidth: 95vw;\n\t\tborder-top: 1px solid #ccc;\n\n\t\t>.title {\n\t\t\tfont-size: 36rpx;\n\t\t\tfont-weight: bold;\n\t\t\tmargin: 30rpx 0;\n\t\t\ttext-align: center;\n\t\t\tletter-spacing: 2rpx;\n\t\t}\n\n\t\t.course-item {\n\t\t\tmargin: 20rpx 0;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: flex-start;\n\n\n\t\t\t.left-index {\n\t\t\t\tflex-basis: 21%;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t\tflex-direction: column;\n\t\t\t\tcolor: #333;\n\t\t\t\tmargin-right: 20rpx;\n\n\t\t\t\t>view {\n\t\t\t\t\twidth: fit-content;\n\t\t\t\t\tword-break: keep-all;\n\t\t\t\t}\n\n\t\t\t\t.time {\n\t\t\t\t\tcolor: #3c3c3c;\n\t\t\t\t\tfont-size: 22rpx;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.right-course {\n\t\t\t\tflex-basis: 78%;\n\t\t\t\tcolor: #6598d9;\n\t\t\t\tpadding: 20rpx;\n\t\t\t\tbackground-color: #e9f3fb;\n\t\t\t\tborder-radius: 10rpx;\n\t\t\t\tborder: 1px solid #c3d8ee;\n\n\t\t\t\t>view {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: flex-start;\n\t\t\t\t\tjustify-content: flex-start;\n\t\t\t\t}\n\n\t\t\t\t.title {\n\t\t\t\t\tfont-size: 30rpx;\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\tmargin-right: 10rpx;\n\t\t\t\t\twidth: fit-content;\n\t\t\t\t\tword-break: keep-all;\n\t\t\t\t}\n\n\t\t\t\t.value {\n\t\t\t\t\tfont-size: 30rpx;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.empty {\n\t\t\tfont-size: 40rpx;\n\t\t\tfont-weight: bold;\n\t\t\tmargin-top: 50rpx;\n\t\t\tcolor: #6598d9;\n\t\t\ttext-align: center;\n\t\t}\n\t}\n</style>","import MiniProgramPage from '/Users/zhangrui/Library/Mobile Documents/com~apple~CloudDocs/Desktop/桌面/WeChatApp/course-wechat/pages/calendar-classroom-course/calendar-classroom-course.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","uni","getClassroomCourseAPI","getCurrentDate","getClassroomCourseForCalendarAPI","getDateByWeekandWeekDay","monthMap","onMounted","getCourseConfigAPISync","MiniProgramPage"],"mappings":"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"}